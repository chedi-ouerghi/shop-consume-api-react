{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\chedi\\\\Desktop\\\\projet_git\\\\shopcard\\\\shopping\\\\src\\\\contexts\\\\auth.jsx\",\n  _s = $RefreshSig$();\nimport React, { useReducer, createContext, useEffect } from \"react\";\nimport _get from \"lodash.get\";\nimport useLocalStorage from \"../hooks/useLocalStorage\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  isLoggedIn: false,\n  user: null,\n  isLoggingIn: false\n};\nexport const AuthStateContext = /*#__PURE__*/createContext();\nexport const AuthDispatchContext = /*#__PURE__*/createContext();\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case \"LOGIN_REQUEST\":\n      return {\n        ...state,\n        isLoggedIn: false,\n        user: null,\n        isLoggingIn: true\n      };\n    case \"LOGIN_SUCCESS\":\n      return {\n        ...state,\n        isLoggedIn: true,\n        user: action.payload.user,\n        isLoggingIn: false\n      };\n    case \"LOGIN_FAILURE\":\n      return {\n        ...state,\n        isLoggedIn: false,\n        user: null,\n        isLoggingIn: false\n      };\n    case \"LOGOUT_SUCCESS\":\n      return {\n        ...state,\n        ...initialState\n      };\n    default:\n      throw new Error(`Unknown action: ${action.type}`);\n  }\n};\nexport const signIn = (dispatch, userData) => {\n  localStorage.setItem(\"user\", JSON.stringify(userData));\n  return dispatch({\n    type: \"LOGIN_SUCCESS\",\n    payload: {\n      user: userData\n    }\n  });\n};\nexport const signOut = dispatch => {\n  localStorage.clear();\n  return dispatch({\n    type: \"LOGOUT_SUCCESS\"\n  });\n};\nconst AuthProvider = _ref => {\n  _s();\n  let {\n    children\n  } = _ref;\n  const [persistedUser, setPersistedUser] = useLocalStorage(\"user\", null);\n  const persistedUserState = {\n    ...initialState,\n    user: persistedUser,\n    isLoggedIn: _get(persistedUser, \"username\", \"\").length > 0\n  };\n  const [state, dispatch] = useReducer(reducer, persistedUserState);\n  useEffect(() => {\n    setPersistedUser(state.user);\n  }, [state.isLoggedIn]);\n  return /*#__PURE__*/_jsxDEV(AuthDispatchContext.Provider, {\n    value: dispatch,\n    children: /*#__PURE__*/_jsxDEV(AuthStateContext.Provider, {\n      value: state,\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n};\n_s(AuthProvider, \"UTfNO/Z2Y5Hw4HohdyLfD3Ct2yY=\", false, function () {\n  return [useLocalStorage];\n});\n_c = AuthProvider;\nexport default AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","useReducer","createContext","useEffect","_get","useLocalStorage","initialState","isLoggedIn","user","isLoggingIn","AuthStateContext","AuthDispatchContext","reducer","state","action","type","payload","Error","signIn","dispatch","userData","localStorage","setItem","JSON","stringify","signOut","clear","AuthProvider","children","persistedUser","setPersistedUser","persistedUserState","length"],"sources":["C:/Users/chedi/Desktop/projet_git/shopcard/shopping/src/contexts/auth.jsx"],"sourcesContent":["import React, { useReducer, createContext, useEffect } from \"react\";\r\nimport _get from \"lodash.get\";\r\nimport useLocalStorage from \"../hooks/useLocalStorage\";\r\n\r\nconst initialState = {\r\n  isLoggedIn: false,\r\n  user: null,\r\n  isLoggingIn: false\r\n};\r\n\r\nexport const AuthStateContext = createContext();\r\nexport const AuthDispatchContext = createContext();\r\n\r\nconst reducer = (state, action) => {\r\n  switch (action.type) {\r\n    case \"LOGIN_REQUEST\":\r\n      return {\r\n        ...state,\r\n        isLoggedIn: false,\r\n        user: null,\r\n        isLoggingIn: true\r\n      };\r\n    case \"LOGIN_SUCCESS\":\r\n      return {\r\n        ...state,\r\n        isLoggedIn: true,\r\n        user: action.payload.user,\r\n        isLoggingIn: false\r\n      };\r\n    case \"LOGIN_FAILURE\":\r\n      return {\r\n        ...state,\r\n        isLoggedIn: false,\r\n        user: null,\r\n        isLoggingIn: false\r\n      };\r\n    case \"LOGOUT_SUCCESS\":\r\n      return {\r\n        ...state,\r\n        ...initialState\r\n      };\r\n    default:\r\n      throw new Error(`Unknown action: ${action.type}`);\r\n  }\r\n};\r\n\r\nexport const signIn = (dispatch, userData) => {\r\n  localStorage.setItem(\"user\", JSON.stringify(userData));\r\n  return dispatch({\r\n    type: \"LOGIN_SUCCESS\",\r\n    payload: {\r\n      user: userData\r\n    }\r\n  });\r\n};\r\n\r\nexport const signOut = (dispatch) => {\r\n  localStorage.clear();\r\n  return dispatch({\r\n    type: \"LOGOUT_SUCCESS\"\r\n  });\r\n};\r\n\r\nconst AuthProvider = ({ children }) => {\r\n  const [persistedUser, setPersistedUser] = useLocalStorage(\"user\", null);\r\n  const persistedUserState = {\r\n    ...initialState,\r\n    user: persistedUser,\r\n    isLoggedIn: _get(persistedUser, \"username\", \"\").length > 0\r\n  };\r\n  const [state, dispatch] = useReducer(reducer, persistedUserState);\r\n\r\n  useEffect(() => {\r\n    setPersistedUser(state.user);\r\n  }, [state.isLoggedIn]);\r\n\r\n  return (\r\n    <AuthDispatchContext.Provider value={dispatch}>\r\n      <AuthStateContext.Provider value={state}>\r\n        {children}\r\n      </AuthStateContext.Provider>\r\n    </AuthDispatchContext.Provider>\r\n  );\r\n};\r\n\r\nexport default AuthProvider;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,UAAU,EAAEC,aAAa,EAAEC,SAAS,QAAQ,OAAO;AACnE,OAAOC,IAAI,MAAM,YAAY;AAC7B,OAAOC,eAAe,MAAM,0BAA0B;AAAC;AAEvD,MAAMC,YAAY,GAAG;EACnBC,UAAU,EAAE,KAAK;EACjBC,IAAI,EAAE,IAAI;EACVC,WAAW,EAAE;AACf,CAAC;AAED,OAAO,MAAMC,gBAAgB,gBAAGR,aAAa,EAAE;AAC/C,OAAO,MAAMS,mBAAmB,gBAAGT,aAAa,EAAE;AAElD,MAAMU,OAAO,GAAG,CAACC,KAAK,EAAEC,MAAM,KAAK;EACjC,QAAQA,MAAM,CAACC,IAAI;IACjB,KAAK,eAAe;MAClB,OAAO;QACL,GAAGF,KAAK;QACRN,UAAU,EAAE,KAAK;QACjBC,IAAI,EAAE,IAAI;QACVC,WAAW,EAAE;MACf,CAAC;IACH,KAAK,eAAe;MAClB,OAAO;QACL,GAAGI,KAAK;QACRN,UAAU,EAAE,IAAI;QAChBC,IAAI,EAAEM,MAAM,CAACE,OAAO,CAACR,IAAI;QACzBC,WAAW,EAAE;MACf,CAAC;IACH,KAAK,eAAe;MAClB,OAAO;QACL,GAAGI,KAAK;QACRN,UAAU,EAAE,KAAK;QACjBC,IAAI,EAAE,IAAI;QACVC,WAAW,EAAE;MACf,CAAC;IACH,KAAK,gBAAgB;MACnB,OAAO;QACL,GAAGI,KAAK;QACR,GAAGP;MACL,CAAC;IACH;MACE,MAAM,IAAIW,KAAK,CAAE,mBAAkBH,MAAM,CAACC,IAAK,EAAC,CAAC;EAAC;AAExD,CAAC;AAED,OAAO,MAAMG,MAAM,GAAG,CAACC,QAAQ,EAAEC,QAAQ,KAAK;EAC5CC,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAACJ,QAAQ,CAAC,CAAC;EACtD,OAAOD,QAAQ,CAAC;IACdJ,IAAI,EAAE,eAAe;IACrBC,OAAO,EAAE;MACPR,IAAI,EAAEY;IACR;EACF,CAAC,CAAC;AACJ,CAAC;AAED,OAAO,MAAMK,OAAO,GAAIN,QAAQ,IAAK;EACnCE,YAAY,CAACK,KAAK,EAAE;EACpB,OAAOP,QAAQ,CAAC;IACdJ,IAAI,EAAE;EACR,CAAC,CAAC;AACJ,CAAC;AAED,MAAMY,YAAY,GAAG,QAAkB;EAAA;EAAA,IAAjB;IAAEC;EAAS,CAAC;EAChC,MAAM,CAACC,aAAa,EAAEC,gBAAgB,CAAC,GAAGzB,eAAe,CAAC,MAAM,EAAE,IAAI,CAAC;EACvE,MAAM0B,kBAAkB,GAAG;IACzB,GAAGzB,YAAY;IACfE,IAAI,EAAEqB,aAAa;IACnBtB,UAAU,EAAEH,IAAI,CAACyB,aAAa,EAAE,UAAU,EAAE,EAAE,CAAC,CAACG,MAAM,GAAG;EAC3D,CAAC;EACD,MAAM,CAACnB,KAAK,EAAEM,QAAQ,CAAC,GAAGlB,UAAU,CAACW,OAAO,EAAEmB,kBAAkB,CAAC;EAEjE5B,SAAS,CAAC,MAAM;IACd2B,gBAAgB,CAACjB,KAAK,CAACL,IAAI,CAAC;EAC9B,CAAC,EAAE,CAACK,KAAK,CAACN,UAAU,CAAC,CAAC;EAEtB,oBACE,QAAC,mBAAmB,CAAC,QAAQ;IAAC,KAAK,EAAEY,QAAS;IAAA,uBAC5C,QAAC,gBAAgB,CAAC,QAAQ;MAAC,KAAK,EAAEN,KAAM;MAAA,UACrCe;IAAQ;MAAA;MAAA;MAAA;IAAA;EACiB;IAAA;IAAA;IAAA;EAAA,QACC;AAEnC,CAAC;AAAC,GApBID,YAAY;EAAA,QAC0BtB,eAAe;AAAA;AAAA,KADrDsB,YAAY;AAsBlB,eAAeA,YAAY;AAAC;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}